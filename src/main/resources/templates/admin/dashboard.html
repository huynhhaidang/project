<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:insert="~{fragments :: head('Bảng điều khiển')}"></head>
<body class="admin-body">
<div class="admin-shell">
    <aside class="admin-sidebar">
        <div class="admin-brand">
            <img th:src="@{/theme/images/main-logo.png}" alt="TechShop" class="logo">
            <div>
                <div>TechShop</div>
                <small>Admin Panel</small>
            </div>
        </div>
        <nav class="admin-nav">
            <a th:href="@{/admin}">Bảng điều khiển</a>
            <a th:href="@{/admin/products}">Sản phẩm</a>
            <a th:href="@{/admin/categories}">Danh mục</a>
            <a th:href="@{/admin/orders}">Đơn hàng</a>
            <a th:href="@{/admin/users}">Người dùng</a>
            <a th:href="@{/}">Về trang chủ</a>
        </nav>
    </aside>
    <div class="admin-content">
        <div class="admin-topbar">
            <div>
                <h1>Thống kê</h1>
                <div class="text-muted">Tổng quan hoạt động bán hàng</div>
            </div>
            <div class="d-flex gap-2 flex-wrap">
                <a class="btn btn-outline-gray btn-sm" th:href="@{/admin/products}">Sản phẩm</a>
                <a class="btn btn-outline-gray btn-sm" th:href="@{/admin/categories}">Danh mục</a>
                <a class="btn btn-outline-gray btn-sm" th:href="@{/admin/users}">Người dùng</a>
                <a class="btn btn-outline-gray btn-sm" th:href="@{/admin/orders}">Đơn hàng</a>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <h3>Tổng doanh thu (hoàn tất)</h3>
                <p class="product-price-vnd" th:text="${#numbers.formatDecimal(totalRevenue, 0, 'COMMA', 0, 'POINT')} + ' đ'"></p>
            </div>
            <div class="stat-card">
                <h3>Tổng số đơn</h3>
                <p class="product-price-vnd" th:text="${totalOrders}"></p>
            </div>
        </div>

        <div class="chart-card">
            <h3>Doanh thu 7 ngày gần nhất</h3>
            <canvas id="revenueChart" height="120"></canvas>
        </div>
    </div>
</div>

<script th:src="@{https://cdn.jsdelivr.net/npm/chart.js}"></script>
<script th:inline="javascript">
    const labels = [[${dailyRevenue.keySet()}]];
    const data = [[${dailyRevenue.values()}]];

    new Chart(document.getElementById('revenueChart'), {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                label: 'Doanh thu',
                data: data,
                borderColor: '#0f62fe',
                backgroundColor: 'rgba(15, 98, 254, 0.2)',
                tension: 0.3
            }]
        }
    });
</script>

<div th:replace="~{fragments :: footer-scripts}"></div>
</body>
</html>
